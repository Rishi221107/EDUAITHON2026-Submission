#!/usr/bin/env bash
set -e

echo "üöÄ Installing OpenWebUI + Ollama..."

# 1Ô∏è‚É£ Check Docker
if ! command -v docker &> /dev/null; then
  echo "‚ùå Docker not found. Please install Docker first."
  exit 1
fi

# 2Ô∏è‚É£ Check Docker Compose
if ! docker compose version &> /dev/null; then
  echo "‚ùå Docker Compose not found."
  exit 1
fi

# 3Ô∏è‚É£ Clone repo
REPO_URL="https://github.com/YOUR_GITHUB_USERNAME/openwebui-ollama-setup.git"
DIR_NAME="openwebui-ollama-setup"

if [ ! -d "$DIR_NAME" ]; then
  git clone "$REPO_URL"
fi

cd "$DIR_NAME"

# 4Ô∏è‚É£ Environment setup
if [ ! -f ".env" ]; then
  cp .env.example .env
fi

# 5Ô∏è‚É£ Start services
docker compose up -d

# 6Ô∏è‚É£ Pull model
echo "üì• Pulling Ollama model..."
docker exec -it ollama ollama pull llama3.2

echo ""
echo "‚úÖ Installation Complete!"
echo "üåê OpenWebUI ‚Üí http://localhost:3000"
echo "ü§ñ Model ‚Üí llama3.2"
